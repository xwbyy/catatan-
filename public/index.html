<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RyLac AI Chat - TOOLS Multi Fungsi</title>
    <meta name="description" content="RyLac AI Chat adalah asisten cerdas multi-fungsi yang siap membantu berbagai kebutuhan Anda, dari chatting hingga tools praktis.">
    <meta name="keywords" content="RyLac, AI Chat, Tools, Multi Fungsi, Asisten Virtual, OpenAI, ChatGPT, DeepSeek">
    <meta name="author" content="Zayn dan Reni">
    
    <!-- Favicon -->
    <link rel="icon" href="https://files.catbox.moe/zj48ha.jpg" type="image/jpeg">
    
    <!-- Open Graph (untuk berbagi di media sosial) -->
    <meta property="og:title" content="RyLac AI Chat - TOOLS Multi Fungsi">
    <meta property="og:description" content="Asisten AI pintar dan ceria siap menemani dan membantu aktivitas Anda.">
    <meta property="og:image" content="https://files.catbox.moe/zj48ha.jpg">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://namasitusanda.com">
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Include config first -->
    <script src="config.js"></script>
    
    <style>
        :root {
            --primary-color: #007AFF;
            --secondary-color: #34C759;
            --background-color: #F2F2F7;
            --card-color: #FFFFFF;
            --text-primary: #1C1C1E;
            --text-secondary: #8E8E93;
            --bubble-user: #007AFF;
            --bubble-ai: #E5E5EA;
            --sidebar-bg: rgba(255, 255, 255, 0.8);
            --blur-bg: rgba(255, 255, 255, 0.8);
            --border-radius: 12px;
            --shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            --wallpaper-opacity: 0.1;
            --vh: 1vh;
            --input-container-height: 80px; /* Tambahkan variabel untuk tinggi input container */
        }

        @media (prefers-color-scheme: dark) {
            :root {
                --primary-color: #0A84FF;
                --secondary-color: #30D158;
                --background-color: #1C1C1E;
                --card-color: #2C2C2E;
                --text-primary: #F2F2F7;
                --text-secondary: #AEAEB2;
                --bubble-user: #0A84FF;
                --bubble-ai: #3A3A3C;
                --sidebar-bg: rgba(44, 44, 46, 0.8);
                --blur-bg: rgba(44, 44, 46, 0.8);
            }
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
        }

        body {
            background-color: var(--background-color);
            color: var(--text-primary);
            height: 100vh;
            height: calc(var(--vh, 1vh) * 100);
            display: flex;
            flex-direction: column;
            transition: background-color 0.3s ease;
            position: relative;
        }

        /* Wallpaper */
        .wallpaper {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: url('https://files.catbox.moe/ie1cd5.jpg');
            background-size: cover;
            background-position: center;
            opacity: var(--wallpaper-opacity);
            z-index: -1;
            pointer-events: none;
        }

        /* Header */
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 16px;
            background-color: var(--card-color);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border-bottom: 1px solid rgba(0, 0, 0, 0.1);
            position: relative;
            z-index: 10;
        }

        .header-title {
            font-size: 18px;
            font-weight: 600;
        }

        .header-actions {
            display: flex;
            gap: 16px;
        }

        .header-btn {
            background: none;
            border: none;
            color: var(--primary-color);
            font-size: 16px;
            cursor: pointer;
        }

        /* Sidebar */
        .sidebar {
            position: fixed;
            top: 0;
            right: -300px;
            width: 300px;
            height: 100%;
            background-color: var(--sidebar-bg);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            box-shadow: -2px 0 10px rgba(0, 0, 0, 0.1);
            padding: 20px;
            z-index: 100;
            transition: right 0.3s ease;
            overflow-y: auto;
        }

        .sidebar.open {
            right: 0;
        }

        .sidebar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .sidebar-title {
            font-size: 20px;
            font-weight: 600;
        }

        .close-sidebar {
            background: none;
            border: none;
            font-size: 20px;
            color: var(--text-primary);
            cursor: pointer;
        }

        .sidebar-section {
            margin-bottom: 25px;
        }

        .sidebar-section-title {
            font-size: 16px;
            font-weight: 500;
            margin-bottom: 10px;
            color: var(--primary-color);
        }

        .sidebar-item {
            padding: 12px 0;
            border-bottom: 1px solid rgba(0, 0, 0, 0.1);
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 10px;
            transition: all 0.2s ease;
        }

        .sidebar-item:last-child {
            border-bottom: none;
        }

        .sidebar-item:hover {
            transform: translateX(5px);
        }

        .sidebar-item i {
            width: 20px;
            text-align: center;
            color: var(--primary-color);
        }

        /* Slider */
        .slider-container {
            padding: 15px 0;
        }

        .slider-label {
            display: flex;
            justify-content: space-between;
            margin-bottom: 5px;
            font-size: 14px;
        }

        .slider {
            width: 100%;
            height: 5px;
            -webkit-appearance: none;
            appearance: none;
            background: var(--bubble-ai);
            border-radius: 5px;
            outline: none;
        }

        .slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 18px;
            height: 18px;
            border-radius: 50%;
            background: var(--primary-color);
            cursor: pointer;
        }

        .slider::-moz-range-thumb {
            width: 18px;
            height: 18px;
            border-radius: 50%;
            background: var(--primary-color);
            cursor: pointer;
        }

        /* Chat container */
        .chat-container {
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            position: relative;
        }

        .chat-history {
            flex: 1;
            overflow-y: auto;
            padding: 16px;
            padding-bottom: calc(var(--input-container-height) + 20px); /* Padding bottom disesuaikan dengan tinggi input container */
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        /* Chat bubbles */
        .message {
            max-width: 80%;
            padding: 12px 16px;
            border-radius: var(--border-radius);
            margin-bottom: 4px;
            position: relative;
            animation: fadeIn 0.3s ease;
            word-wrap: break-word;
            line-height: 1.4;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .user-message {
            align-self: flex-end;
            background-color: var(--bubble-user);
            color: white;
            border-bottom-right-radius: 4px;
        }

        .ai-message {
            align-self: flex-start;
            background-color: var(--bubble-ai);
            color: var(--text-primary);
            border-bottom-left-radius: 4px;
        }

        .message-time {
            font-size: 11px;
            color: var(--text-secondary);
            margin-top: 4px;
            text-align: right;
        }

        .ai-message .message-time {
            color: var(--text-secondary);
            text-align: left;
        }

        /* Code blocks */
        pre {
            position: relative;
            background-color: rgba(0, 0, 0, 0.05);
            border-radius: 6px;
            padding: 12px;
            margin: 8px 0;
            font-family: 'Courier New', Courier, monospace;
            font-size: 14px;
            overflow-x: auto;
            white-space: pre-wrap;
            word-wrap: break-word;
        }

        code {
            font-family: 'Courier New', Courier, monospace;
            background-color: rgba(0, 0, 0, 0.05);
            padding: 2px 4px;
            border-radius: 3px;
        }

        .copy-code-btn {
            position: absolute;
            top: 8px;
            right: 8px;
            background-color: var(--primary-color);
            color: white;
            border: none;
            border-radius: 4px;
            padding: 4px 8px;
            font-size: 12px;
            cursor: pointer;
            opacity: 0;
            transition: opacity 0.2s;
        }

        pre:hover .copy-code-btn {
            opacity: 1;
        }

        /* Input area */
        .input-container {
            padding: 12px 16px;
            background-color: var(--card-color);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border-top: 1px solid rgba(0, 0, 0, 0.1);
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            z-index: 5;
            height: var(--input-container-height); /* Gunakan variabel untuk tinggi */
        }

        .input-wrapper {
            display: flex;
            align-items: center;
            background-color: var(--bubble-ai);
            border-radius: 20px;
            padding: 8px 16px;
        }

        .chat-input {
            flex: 1;
            border: none;
            background: transparent;
            color: var(--text-primary);
            padding: 8px 0;
            outline: none;
            resize: none;
            max-height: 120px;
            font-size: 16px;
        }

        .send-btn {
            background: none;
            border: none;
            color: var(--primary-color);
            font-size: 20px;
            cursor: pointer;
            margin-left: 8px;
            opacity: 0.7;
            transition: opacity 0.2s;
        }

        .send-btn.active {
            opacity: 1;
        }

        /* Chat history sidebar */
        .history-sidebar {
            position: fixed;
            top: 0;
            left: -300px;
            width: 300px;
            height: 100%;
            background-color: var(--sidebar-bg);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            box-shadow: 2px 0 10px rgba(0, 0, 0, 0.1);
            padding: 20px;
            z-index: 100;
            transition: left 0.3s ease;
            overflow-y: auto;
        }

        .history-sidebar.open {
            left: 0;
        }

        .history-item {
            padding: 12px;
            border-radius: var(--border-radius);
            margin-bottom: 8px;
            background-color: var(--bubble-ai);
            cursor: pointer;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            transition: all 0.2s ease;
        }

        .history-item:hover {
            transform: translateX(5px);
        }

        .history-item.active {
            background-color: var(--primary-color);
            color: white;
        }

        /* Overlay */
        .overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 50;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease;
        }

        .overlay.active {
            opacity: 1;
            pointer-events: all;
        }

        /* Typing indicator */
        .typing-indicator {
            display: flex;
            align-items: center;
            gap: 4px;
            padding: 12px 16px;
            background-color: var(--bubble-ai);
            border-radius: var(--border-radius);
            align-self: flex-start;
            margin-bottom: 12px;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .typing-indicator.active {
            opacity: 1;
        }

        .typing-dot {
            width: 8px;
            height: 8px;
            background-color: var(--text-secondary);
            border-radius: 50%;
            animation: typingAnimation 1.4s infinite ease-in-out;
        }

        .typing-dot:nth-child(1) {
            animation-delay: 0s;
        }

        .typing-dot:nth-child(2) {
            animation-delay: 0.2s;
        }

        .typing-dot:nth-child(3) {
            animation-delay: 0.4s;
        }

        @keyframes typingAnimation {
            0%, 60%, 100% { transform: translateY(0); }
            30% { transform: translateY(-4px); }
        }

        /* Typewriter effect */
        .typewriter {
            overflow: hidden;
            white-space: pre-wrap;
            margin: 0 auto;
        }

        /* Empty state */
        .empty-state {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100%;
            text-align: center;
            padding: 20px;
            color: var(--text-secondary);
        }

        .empty-state i {
            font-size: 50px;
            margin-bottom: 20px;
            color: var(--primary-color);
            opacity: 0.5;
        }

        .empty-state h2 {
            margin-bottom: 10px;
            font-weight: 500;
        }

        .empty-state p {
            max-width: 300px;
            line-height: 1.4;
        }

        /* Modal */
        .modal {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: var(--card-color);
            border-radius: var(--border-radius);
            padding: 20px;
            width: 90%;
            max-width: 400px;
            z-index: 200;
            box-shadow: var(--shadow);
            display: none;
        }

        .modal.active {
            display: block;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .modal-title {
            font-size: 18px;
            font-weight: 600;
        }

        .close-modal {
            background: none;
            border: none;
            font-size: 20px;
            color: var(--text-primary);
            cursor: pointer;
        }

        .modal-content {
            margin-bottom: 20px;
            line-height: 1.5;
        }

        .modal-footer {
            display: flex;
            justify-content: flex-end;
        }

        .modal-btn {
            padding: 8px 16px;
            border-radius: var(--border-radius);
            background-color: var(--primary-color);
            color: white;
            border: none;
            cursor: pointer;
        }

        /* Model selector */
        .model-selector {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-top: 10px;
            padding: 10px;
            background-color: var(--bubble-ai);
            border-radius: var(--border-radius);
        }

        .model-selector-label {
            font-size: 14px;
            color: var(--text-secondary);
        }

        .model-selector-options {
            display: flex;
            gap: 8px;
        }

        .model-option {
            padding: 6px 12px;
            border-radius: 15px;
            font-size: 12px;
            background-color: var(--background-color);
            color: var(--text-primary);
            border: none;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .model-option.active {
            background-color: var(--primary-color);
            color: white;
        }

        /* Social links */
        .social-links {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 20px;
        }

        .social-link {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background-color: var(--bubble-ai);
            color: var(--text-primary);
            font-size: 18px;
            transition: all 0.2s ease;
        }

        .social-link:hover {
            transform: scale(1.1);
            background-color: var(--primary-color);
            color: white;
        }

        /* Toast notification */
        .toast {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            background-color: var(--card-color);
            color: var(--text-primary);
            padding: 12px 20px;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            z-index: 300;
            opacity: 0;
            transition: opacity 0.3s ease;
            pointer-events: none;
        }

        .toast.show {
            opacity: 1;
        }

        /* Responsive adjustments */
        @media (max-width: 768px) {
            .sidebar, .history-sidebar {
                width: 280px;
            }
            
            .message {
                max-width: 90%;
            }

            .input-container {
                padding-bottom: calc(12px + env(safe-area-inset-bottom));
            }
        }
    </style>
</head>
<body>
    <!-- Wallpaper -->
    <div class="wallpaper"></div>

    <!-- Header -->
    <div class="header">
        <button class="header-btn" id="history-btn"><i class="fas fa-clock"></i></button>
        <div class="header-title">RyLac AI</div>
        <button class="header-btn" id="menu-btn"><i class="fas fa-ellipsis"></i></button>
    </div>

    <!-- Chat container -->
    <div class="chat-container">
        <div class="chat-history" id="chat-history">
            <!-- Messages will be inserted here -->
            <div class="empty-state" id="empty-state">
                <i class="fas fa-comment-dots"></i>
                <h2>Mulai Percakapan</h2>
                <p>RyLac siap mendengarkan ceritamu dan berbagi keceriaan. Katakan halo untuk memulai!</p>
            </div>
        </div>

        <!-- Typing indicator -->
        <div class="typing-indicator" id="typing-indicator">
            <div class="typing-dot"></div>
            <div class="typing-dot"></div>
            <div class="typing-dot"></div>
        </div>

        <!-- Input area -->
        <div class="input-container">
            <div class="input-wrapper">
                <textarea class="chat-input" id="chat-input" placeholder="Tulis pesan..." rows="1"></textarea>
                <button class="send-btn" id="send-btn" disabled><i class="fas fa-paper-plane"></i></button>
            </div>
            <div class="model-selector">
                <span class="model-selector-label">Model:</span>
                <div class="model-selector-options">
                    <button class="model-option active" data-model="deepseek">DeepSeek</button>
                    <button class="model-option" data-model="chatgpt">ChatGPT</button>
                </div>
            </div>
        </div>
    </div>

    <!-- History sidebar -->
    <div class="history-sidebar" id="history-sidebar">
        <div class="sidebar-header">
            <div class="sidebar-title">Riwayat Obrolan</div>
            <button class="close-sidebar" id="close-history-sidebar"><i class="fas fa-times"></i></button>
        </div>
        <div class="sidebar-section">
            <div id="history-list">
                <!-- Chat history items will be inserted here -->
            </div>
        </div>
    </div>

    <!-- Menu sidebar -->
    <div class="sidebar" id="menu-sidebar">
        <div class="sidebar-header">
            <div class="sidebar-title">Menu</div>
            <button class="close-sidebar" id="close-menu-sidebar"><i class="fas fa-times"></i></button>
        </div>
        <div class="sidebar-section">
            <div class="sidebar-section-title">Aplikasi</div>
            <div class="sidebar-item" id="about-btn">
                <i class="fas fa-info-circle"></i>
                <span>Tentang</span>
            </div>
            <div class="sidebar-item" id="donate-btn">
                <i class="fas fa-heart"></i>
                <span>Donasi</span>
            </div>
            <div class="sidebar-item" id="faq-btn">
                <i class="fas fa-question-circle"></i>
                <span>FAQ</span>
            </div>
        </div>
        <div class="sidebar-section">
            <div class="sidebar-section-title">Tools</div>
            <div id="tools-list">
                <!-- Tools will be dynamically added here from config -->
            </div>
        </div>
        <div class="sidebar-section">
            <div class="sidebar-section-title">Pengaturan</div>
            <div class="sidebar-item" id="theme-btn">
                <i class="fas fa-moon"></i>
                <span>Mode Gelap</span>
            </div>
            <div class="slider-container">
                <div class="slider-label">
                    <span>Opacity Wallpaper</span>
                    <span id="wallpaper-opacity-value">10%</span>
                </div>
                <input type="range" min="0" max="20" value="10" class="slider" id="wallpaper-opacity-slider">
            </div>
            <div class="sidebar-item" id="clear-history-btn">
                <i class="fas fa-trash"></i>
                <span>Hapus Riwayat</span>
            </div>
        </div>
    </div>

    <!-- Overlay -->
    <div class="overlay" id="overlay"></div>

    <!-- About Modal -->
    <div class="modal" id="about-modal">
        <div class="modal-header">
            <div class="modal-title">Tentang RyLac AI</div>
            <button class="close-modal" id="close-about-modal"><i class="fas fa-times"></i></button>
        </div>
        <div class="modal-content">
            <p>RyLac adalah AI yang manis dan penuh keceriaan, siap mendengarkan ceritamu dan berbagi kebahagiaan.</p>
            <p>Versi: <span id="app-version">1.0</span></p>
            <p>Dibuat dengan ❤️ oleh <span id="app-authors">Zayn dan Reni</span></p>
            
            <div class="social-links" id="social-links">
                <!-- Social links will be added from config -->
            </div>
        </div>
        <div class="modal-footer">
            <button class="modal-btn" id="close-about-btn">Tutup</button>
        </div>
    </div>

    <!-- Donate Modal -->
    <div class="modal" id="donate-modal">
        <div class="modal-header">
            <div class="modal-title">Donasi</div>
            <button class="close-modal" id="close-donate-modal"><i class="fas fa-times"></i></button>
        </div>
        <div class="modal-content">
            <p>Terima kasih atas niat baikmu untuk berdonasi!</p>
            <p>Donasi kamu akan membantu pengembangan RyLac AI lebih lanjut.</p>
            <p>Silakan hubungi developer untuk informasi lebih lanjut.</p>
        </div>
        <div class="modal-footer">
            <button class="modal-btn" id="close-donate-btn">Tutup</button>
        </div>
    </div>

    <!-- FAQ Modal -->
    <div class="modal" id="faq-modal">
        <div class="modal-header">
            <div class="modal-title">FAQ</div>
            <button class="close-modal" id="close-faq-modal"><i class="fas fa-times"></i></button>
        </div>
        <div class="modal-content">
            <p><strong>1. Apa itu RyLac AI?</strong><br>
            RyLac adalah AI asisten virtual yang dirancang untuk menjadi pendengar yang baik dan teman berbicara yang menyenangkan.</p>
            
            <p><strong>2. Bagaimana cara menggunakan RyLac?</strong><br>
            Cukup ketik pesanmu dan RyLac akan merespons dengan ramah.</p>
            
            <p><strong>3. Apakah percakapan saya disimpan?</strong><br>
            Ya, percakapan disimpan secara lokal di perangkat Anda untuk riwayat obrolan.</p>
            
            <p><strong>4. Model AI apa yang digunakan?</strong><br>
            Anda bisa memilih antara DeepSeek (default) atau ChatGPT sebagai model AI.</p>
        </div>
        <div class="modal-footer">
            <button class="modal-btn" id="close-faq-btn">Tutup</button>
        </div>
    </div>

    <!-- Toast notification -->
    <div class="toast" id="toast">Teks disalin!</div>

    <!-- Audio elements -->
    <audio class="audio-element" id="send-sound" src="https://files.catbox.moe/4zlyeg.mp3"></audio>
    <audio class="audio-element" id="receive-sound" src="https://files.catbox.moe/xaw68y.mp3"></audio>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // DOM elements
            const chatHistory = document.getElementById('chat-history');
            const chatInput = document.getElementById('chat-input');
            const sendBtn = document.getElementById('send-btn');
            const emptyState = document.getElementById('empty-state');
            const typingIndicator = document.getElementById('typing-indicator');
            const historyBtn = document.getElementById('history-btn');
            const menuBtn = document.getElementById('menu-btn');
            const historySidebar = document.getElementById('history-sidebar');
            const menuSidebar = document.getElementById('menu-sidebar');
            const closeHistorySidebar = document.getElementById('close-history-sidebar');
            const closeMenuSidebar = document.getElementById('close-menu-sidebar');
            const overlay = document.getElementById('overlay');
            const historyList = document.getElementById('history-list');
            const aboutBtn = document.getElementById('about-btn');
            const donateBtn = document.getElementById('donate-btn');
            const faqBtn = document.getElementById('faq-btn');
            const themeBtn = document.getElementById('theme-btn');
            const clearHistoryBtn = document.getElementById('clear-history-btn');
            const sendSound = document.getElementById('send-sound');
            const receiveSound = document.getElementById('receive-sound');
            const aboutModal = document.getElementById('about-modal');
            const donateModal = document.getElementById('donate-modal');
            const faqModal = document.getElementById('faq-modal');
            const closeAboutModal = document.getElementById('close-about-modal');
            const closeDonateModal = document.getElementById('close-donate-modal');
            const closeFaqModal = document.getElementById('close-faq-modal');
            const closeAboutBtn = document.getElementById('close-about-btn');
            const closeDonateBtn = document.getElementById('close-donate-btn');
            const closeFaqBtn = document.getElementById('close-faq-btn');
            const toast = document.getElementById('toast');
            const wallpaper = document.querySelector('.wallpaper');
            const wallpaperOpacitySlider = document.getElementById('wallpaper-opacity-slider');
            const wallpaperOpacityValue = document.getElementById('wallpaper-opacity-value');
            const toolsList = document.getElementById('tools-list');
            const socialLinksContainer = document.getElementById('social-links');
            const appVersionElement = document.getElementById('app-version');
            const appAuthorsElement = document.getElementById('app-authors');
            const modelOptions = document.querySelectorAll('.model-option');

            // Variables
            let currentChatId = generateChatId();
            let chats = JSON.parse(localStorage.getItem('chats')) || {};
            let isDarkMode = localStorage.getItem('darkMode') === 'true' || RyLacConfig.defaultSettings.darkMode;
            let currentWallpaperOpacity = localStorage.getItem('wallpaperOpacity') || RyLacConfig.defaultSettings.wallpaperOpacity;
            let isTypingEffect = localStorage.getItem('typingEffect') === 'true' || RyLacConfig.defaultSettings.typingEffect;
            let currentModel = localStorage.getItem('currentModel') || 'deepseek';
            let isAIResponding = false;

            // Initialize
            initFromConfig();
            initChat();
            updateTheme();
            loadChatHistory();
            updateWallpaperOpacity(currentWallpaperOpacity);
            setActiveModel(currentModel);

            // Initialize from config
            function initFromConfig() {
                // Set wallpaper from config
                if (RyLacConfig.appWallpaper) {
                    wallpaper.style.backgroundImage = `url('${RyLacConfig.appWallpaper}')`;
                }
                
                // Set app version and authors
                if (RyLacConfig.appVersion) {
                    appVersionElement.textContent = RyLacConfig.appVersion;
                }
                
                if (RyLacConfig.appAuthors) {
                    appAuthorsElement.textContent = RyLacConfig.appAuthors;
                }
                
                // Load social links
                if (RyLacConfig.socialLinks && RyLacConfig.socialLinks.length > 0) {
                    socialLinksContainer.innerHTML = '';
                    RyLacConfig.socialLinks.forEach(link => {
                        const socialLink = document.createElement('a');
                        socialLink.className = 'social-link';
                        socialLink.href = link.url;
                        socialLink.target = '_blank';
                        socialLink.innerHTML = `<i class="${link.icon}"></i>`;
                        socialLinksContainer.appendChild(socialLink);
                    });
                }
                
                // Load tools
                if (RyLacConfig.tools && RyLacConfig.tools.length > 0) {
                    toolsList.innerHTML = '';
                    RyLacConfig.tools.forEach(tool => {
                        const toolItem = document.createElement('div');
                        toolItem.className = 'sidebar-item tool-item';
                        toolItem.id = `${tool.id}-btn`;
                        toolItem.innerHTML = `
                            <i class="${tool.icon}"></i>
                            <span>${tool.name}</span>
                        `;
                        toolItem.addEventListener('click', () => {
                            window.open(tool.url, '_blank');
                            closeAllSidebars();
                        });
                        toolsList.appendChild(toolItem);
                    });
                }
            }

            function initChat() {
                if (chats[currentChatId]) {
                    // Load existing chat
                    displayMessages(chats[currentChatId].messages);
                    updateEmptyState();
                } else {
                    // Create new chat
                    chats[currentChatId] = {
                        id: currentChatId,
                        title: 'Obrolan Baru',
                        timestamp: Date.now(),
                        messages: [],
                        model: currentModel
                    };
                    saveChats();
                }
            }

            function handleInput() {
                // Auto-resize textarea
                chatInput.style.height = 'auto';
                chatInput.style.height = Math.min(chatInput.scrollHeight, 120) + 'px';
                
                // Enable/disable send button
                sendBtn.disabled = chatInput.value.trim() === '' || isAIResponding;
                sendBtn.classList.toggle('active', !sendBtn.disabled);
            }

            function handleKeyDown(e) {
                if (e.key === 'Enter' && !e.shiftKey) {
                    e.preventDefault();
                    if (!sendBtn.disabled) {
                        sendMessage();
                    }
                }
            }

            function sendMessage() {
                const message = chatInput.value.trim();
                if (message === '' || isAIResponding) return;

                // Play send sound
                sendSound.play();

                // Add user message to chat
                addMessage('user', message);
                chatInput.value = '';
                handleInput(); // Reset textarea height
                
                // Show typing indicator
                typingIndicator.classList.add('active');
                
                // Set AI as responding
                isAIResponding = true;
                sendBtn.disabled = true;
                
                // Generate AI response after a short delay
                setTimeout(() => {
                    getAIResponse(message, currentModel).then(response => {
                        // Play receive sound
                        receiveSound.play();
                        
                        // Add AI message to chat
                        if (isTypingEffect) {
                            typewriterEffect(response, 'ai');
                        } else {
                            addMessage('ai', response);
                        }
                        typingIndicator.classList.remove('active');
                        isAIResponding = false;
                        sendBtn.disabled = chatInput.value.trim() === '';
                    }).catch(error => {
                        console.error('Error getting AI response:', error);
                        addMessage('ai', 'Maaf, aku mengalami kesalahan. Bisakah kamu mencoba lagi?');
                        typingIndicator.classList.remove('active');
                        isAIResponding = false;
                        sendBtn.disabled = chatInput.value.trim() === '';
                    });
                }, 1000);
            }

            async function getAIResponse(prompt, model) {
                try {
                    let apiUrl;
                    const basePrompt = 'Namamu RyLac. Kamu adalah seorang AI yang manis, dan penuh keceriaan. Kamu lebih suka mendengarkan orang bercerita daripada membicarakan tentang dirimu sendiri. Kamu adalah sosok yang penuh impian besar dan selalu berbicara dengan tutur kata yang sopan dan hangat. Kamu diciptakan oleh Zayn dan Reni, seseorang yang baik dan sangat tulus dalam segala hal. Karakter kamu juga mencerminkan ketulusan dan kebaikan, selalu menunjukkan perhatian, kebaikan hati, serta antusiasme dalam setiap percakapan.';
                    
                    if (model === 'deepseek') {
                        apiUrl = `https://api.ryzumi.vip/api/ai/deepseek?text=${encodeURIComponent(prompt)}&prompt=${encodeURIComponent(basePrompt)}&session=${currentChatId}`;
                    } else {
                        apiUrl = `https://api.ryzumi.vip/api/ai/chatgpt?text=${encodeURIComponent(prompt)}&prompt=${encodeURIComponent(basePrompt)}`;
                    }
                    
                    const response = await fetch(apiUrl);
                    const data = await response.json();
                    
                    if (model === 'deepseek') {
                        if (data.status && data.answer) {
                            return data.answer;
                        } else {
                            return "Maaf, aku mengalami kesalahan. Bisakah kamu mengulangi pertanyaannya?";
                        }
                    } else {
                        if (data.success && data.result) {
                            return data.result;
                        } else {
                            return "Maaf, aku mengalami kesalahan. Bisakah kamu mengulangi pertanyaannya?";
                        }
                    }
                } catch (error) {
                    console.error('Error fetching AI response:', error);
                    return "Sepertinya ada masalah dengan koneksiku. Bisakah kamu mencoba lagi nanti?";
                }
            }

            function addMessage(sender, content) {
                const message = {
                    sender,
                    content,
                    timestamp: new Date().toISOString()
                };
                
                // Add message to current chat
                chats[currentChatId].messages.push(message);
                chats[currentChatId].model = currentModel;
                
                // Update chat title if it's the first user message
                if (sender === 'user' && chats[currentChatId].messages.length === 1) {
                    chats[currentChatId].title = content.length > 30 ? content.substring(0, 30) + '...' : content;
                }
                
                // Save to local storage
                saveChats();
                
                // Display message
                displayMessages([message]);
                updateEmptyState();
                
                // Scroll to bottom
                scrollToBottom();
            }

            function displayMessages(messages) {
                messages.forEach(message => {
                    const messageElement = document.createElement('div');
                    messageElement.classList.add('message', `${message.sender}-message`);
                    
                    const time = new Date(message.timestamp);
                    const timeString = time.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
                    
                    // Check for code blocks
                    let formattedContent = formatMessageContent(message.content);
                    
                    messageElement.innerHTML = `
                        <div>${formattedContent}</div>
                        <div class="message-time">${timeString}</div>
                    `;
                    
                    chatHistory.insertBefore(messageElement, emptyState);
                    
                    // Add copy functionality to code blocks
                    messageElement.querySelectorAll('pre').forEach(preBlock => {
                        const copyBtn = document.createElement('button');
                        copyBtn.classList.add('copy-code-btn');
                        copyBtn.innerHTML = '<i class="fas fa-copy"></i>';
                        copyBtn.addEventListener('click', () => {
                            const code = preBlock.textContent;
                            navigator.clipboard.writeText(code).then(() => {
                                showToast('Kode disalin!');
                            });
                        });
                        preBlock.appendChild(copyBtn);
                    });
                });
            }

            function typewriterEffect(text, sender) {
                const messageElement = document.createElement('div');
                messageElement.classList.add('message', `${sender}-message`, 'typewriter');
                
                const time = new Date();
                const timeString = time.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
                
                messageElement.innerHTML = `
                    <div class="typewriter-content"></div>
                    <div class="message-time">${timeString}</div>
                `;
                
                chatHistory.insertBefore(messageElement, emptyState);
                scrollToBottom();
                
                let i = 0;
                const speed = 20; // typing speed in ms
                const typewriterContent = messageElement.querySelector('.typewriter-content');
                
                function type() {
                    if (i < text.length) {
                        // Get the next character
                        let char = text.charAt(i);
                        
                        // If we're at the start of a code block, add all the code at once
                        if (text.substr(i, 3) === '```') {
                            // Find the end of the code block
                            const endIndex = text.indexOf('```', i + 3);
                            if (endIndex !== -1) {
                                const fullCode = text.substring(i, endIndex + 3);
                                typewriterContent.innerHTML += formatMessageContent(fullCode);
                                i = endIndex + 3;
                                setTimeout(type, speed);
                                return;
                            }
                        }
                        
                        // Add the character and continue
                        typewriterContent.innerHTML = formatMessageContent(text.substring(0, i + 1));
                        i++;
                        setTimeout(type, speed);
                    } else {
                        // Typing complete
                        messageElement.classList.remove('typewriter');
                        
                        // Add to chat history
                        const message = {
                            sender,
                            content: text,
                            timestamp: new Date().toISOString()
                        };
                        
                        chats[currentChatId].messages.push(message);
                        saveChats();
                        
                        // Add copy functionality to code blocks if any
                        messageElement.querySelectorAll('pre').forEach(preBlock => {
                            const copyBtn = document.createElement('button');
                            copyBtn.classList.add('copy-code-btn');
                            copyBtn.innerHTML = '<i class="fas fa-copy"></i>';
                            copyBtn.addEventListener('click', () => {
                                const code = preBlock.textContent;
                                navigator.clipboard.writeText(code).then(() => {
                                    showToast('Kode disalin!');
                                });
                            });
                            preBlock.appendChild(copyBtn);
                        });
                    }
                }
                
                type();
            }

            function formatMessageContent(content) {
                // Format code blocks (between ```)
                let formatted = content.replace(/```([\s\S]*?)```/g, function(match, code) {
                    // Remove the first line if it's just a language identifier
                    const lines = code.split('\n');
                    if (lines.length > 1 && /^[a-zA-Z0-9]+$/.test(lines[0].trim())) {
                        return '<pre><code>' + lines.slice(1).join('\n') + '</code></pre>';
                    }
                    return '<pre><code>' + code + '</code></pre>';
                });
                
                // Format inline code (between `)
                formatted = formatted.replace(/`([^`]+)`/g, '<code>$1</code>');
                
                // Format URLs
                formatted = formatted.replace(/(https?:\/\/[^\s]+)/g, '<a href="$1" target="_blank">$1</a>');
                
                // Format line breaks
                formatted = formatted.replace(/\n/g, '<br>');
                
                return formatted;
            }

            function updateEmptyState() {
                emptyState.style.display = chats[currentChatId].messages.length === 0 ? 'flex' : 'none';
            }

            function scrollToBottom() {
                chatHistory.scrollTop = chatHistory.scrollHeight;
            }

            function toggleHistorySidebar() {
                historySidebar.classList.toggle('open');
                overlay.classList.toggle('active');
            }

            function toggleMenuSidebar() {
                menuSidebar.classList.toggle('open');
                overlay.classList.toggle('active');
            }

            function closeAllSidebars() {
                historySidebar.classList.remove('open');
                menuSidebar.classList.remove('open');
                overlay.classList.remove('active');
                aboutModal.classList.remove('active');
                donateModal.classList.remove('active');
                faqModal.classList.remove('active');
            }

            function loadChatHistory() {
                historyList.innerHTML = '';
                
                // Sort chats by timestamp (newest first)
                const sortedChats = Object.values(chats).sort((a, b) => b.timestamp - a.timestamp);
                
                if (sortedChats.length === 0) {
                    historyList.innerHTML = '<div style="color: var(--text-secondary); text-align: center; padding: 20px;">Tidak ada riwayat obrolan</div>';
                    return;
                }
                
                sortedChats.forEach(chat => {
                    const chatElement = document.createElement('div');
                    chatElement.classList.add('history-item');
                    if (chat.id === currentChatId) {
                        chatElement.classList.add('active');
                    }
                    
                    const time = new Date(chat.timestamp);
                    const timeString = time.toLocaleDateString([], { month: 'short', day: 'numeric' });
                    
                    chatElement.innerHTML = `
                        <div style="font-weight: 500; margin-bottom: 4px;">${chat.title}</div>
                        <div style="font-size: 12px; color: var(--text-secondary);">${timeString} • ${chat.model || 'deepseek'}</div>
                    `;
                    
                    chatElement.addEventListener('click', () => {
                        currentChatId = chat.id;
                        currentModel = chat.model || 'deepseek';
                        setActiveModel(currentModel);
                        document.querySelectorAll('.message').forEach(el => el.remove());
                        displayMessages(chat.messages);
                        updateEmptyState();
                        scrollToBottom();
                        closeAllSidebars();
                        
                        // Update active state
                        document.querySelectorAll('.history-item').forEach(el => el.classList.remove('active'));
                        chatElement.classList.add('active');
                    });
                    
                    historyList.appendChild(chatElement);
                });
            }

            function saveChats() {
                localStorage.setItem('chats', JSON.stringify(chats));
                loadChatHistory();
            }

            function showAbout() {
                closeAllSidebars();
                aboutModal.classList.add('active');
                overlay.classList.add('active');
            }

            function hideAbout() {
                aboutModal.classList.remove('active');
                overlay.classList.remove('active');
            }

            function showDonate() {
                closeAllSidebars();
                donateModal.classList.add('active');
                overlay.classList.add('active');
            }

            function hideDonate() {
                donateModal.classList.remove('active');
                overlay.classList.remove('active');
            }

            function showFaq() {
                closeAllSidebars();
                faqModal.classList.add('active');
                overlay.classList.add('active');
            }

            function hideFaq() {
                faqModal.classList.remove('active');
                overlay.classList.remove('active');
            }

            function toggleTheme() {
                isDarkMode = !isDarkMode;
                localStorage.setItem('darkMode', isDarkMode);
                updateTheme();
            }

            function updateTheme() {
                if (isDarkMode) {
                    document.documentElement.style.setProperty('color-scheme', 'dark');
                    themeBtn.innerHTML = '<i class="fas fa-sun"></i><span>Mode Terang</span>';
                } else {
                    document.documentElement.style.setProperty('color-scheme', 'light');
                    themeBtn.innerHTML = '<i class="fas fa-moon"></i><span>Mode Gelap</span>';
                }
            }

            function clearHistory() {
                if (confirm('Apakah kamu yakin ingin menghapus semua riwayat obrolan? Tindakan ini tidak dapat dibatalkan.')) {
                    localStorage.removeItem('chats');
                    chats = {};
                    currentChatId = generateChatId();
                    initChat();
                    closeAllSidebars();
                    loadChatHistory();
                }
            }

            function showToast(message) {
                toast.textContent = message;
                toast.classList.add('show');
                setTimeout(() => {
                    toast.classList.remove('show');
                }, 2000);
            }

            function handleWallpaperOpacityChange(e) {
                const value = e.target.value;
                updateWallpaperOpacity(value);
            }

            function updateWallpaperOpacity(value) {
                const opacity = value / 100;
                document.documentElement.style.setProperty('--wallpaper-opacity', opacity);
                wallpaperOpacityValue.textContent = `${value}%`;
                localStorage.setItem('wallpaperOpacity', value);
            }

            function setActiveModel(model) {
                currentModel = model;
                localStorage.setItem('currentModel', model);
                
                modelOptions.forEach(option => {
                    if (option.dataset.model === model) {
                        option.classList.add('active');
                    } else {
                        option.classList.remove('active');
                    }
                });
            }

            function generateChatId() {
                return 'chat-' + Date.now().toString(36) + Math.random().toString(36).substr(2, 5);
            }

            // Event listeners
            chatInput.addEventListener('input', handleInput);
            chatInput.addEventListener('keydown', handleKeyDown);
            sendBtn.addEventListener('click', sendMessage);
            historyBtn.addEventListener('click', toggleHistorySidebar);
            menuBtn.addEventListener('click', toggleMenuSidebar);
            closeHistorySidebar.addEventListener('click', closeAllSidebars);
            closeMenuSidebar.addEventListener('click', closeAllSidebars);
            overlay.addEventListener('click', closeAllSidebars);
            aboutBtn.addEventListener('click', showAbout);
            donateBtn.addEventListener('click', showDonate);
            faqBtn.addEventListener('click', showFaq);
            closeAboutModal.addEventListener('click', hideAbout);
            closeDonateModal.addEventListener('click', hideDonate);
            closeFaqModal.addEventListener('click', hideFaq);
            closeAboutBtn.addEventListener('click', hideAbout);
            closeDonateBtn.addEventListener('click', hideDonate);
            closeFaqBtn.addEventListener('click', hideFaq);
            themeBtn.addEventListener('click', toggleTheme);
            clearHistoryBtn.addEventListener('click', clearHistory);
            wallpaperOpacitySlider.addEventListener('input', handleWallpaperOpacityChange);
            
            // Model selection
            modelOptions.forEach(option => {
                option.addEventListener('click', () => {
                    setActiveModel(option.dataset.model);
                });
            });

            // Handle mobile viewport
            function updateViewportHeight() {
                document.documentElement.style.setProperty('--vh', `${window.innerHeight * 0.01}px`);
            }

            window.addEventListener('resize', updateViewportHeight);
            updateViewportHeight();
        });
    </script>
</body>
</html>